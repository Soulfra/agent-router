# Caddy reverse proxy configuration for CALOS Agent Router
#
# Caddy is simpler than nginx - automatic HTTPS with Let's Encrypt!
#
# Location: /etc/caddy/Caddyfile
# Reload: sudo systemctl reload caddy
# Or run directly: caddy run --config Caddyfile

# Basic configuration (auto-HTTPS)
yourdomain.com {
    reverse_proxy localhost:5001
}

# With www redirect
www.yourdomain.com {
    redir https://yourdomain.com{uri} permanent
}

# Advanced configuration with logging and headers
# yourdomain.com {
#     # Reverse proxy to CALOS Agent Router
#     reverse_proxy localhost:5001 {
#         # Health check
#         health_uri /health
#         health_interval 30s
#         health_timeout 5s
#
#         # Headers
#         header_up Host {host}
#         header_up X-Real-IP {remote_host}
#         header_up X-Forwarded-For {remote_host}
#         header_up X-Forwarded-Proto {scheme}
#     }
#
#     # Security headers
#     header {
#         Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
#         X-Content-Type-Options "nosniff"
#         X-Frame-Options "SAMEORIGIN"
#         X-XSS-Protection "1; mode=block"
#         -Server
#     }
#
#     # Logging
#     log {
#         output file /var/log/caddy/calos-router.log
#         format json
#     }
#
#     # Rate limiting (requires caddy-ratelimit plugin)
#     # rate_limit {
#     #     zone api {
#     #         key {remote_host}
#     #         events 100
#     #         window 1m
#     #     }
#     # }
#
#     # File upload size
#     request_body {
#         max_size 100MB
#     }
# }

# Multiple domains/subdomains
# api.yourdomain.com {
#     reverse_proxy localhost:5001
# }
#
# admin.yourdomain.com {
#     reverse_proxy localhost:5001
#     basicauth {
#         admin $2a$14$...  # Use 'caddy hash-password' to generate
#     }
# }

# Local development (no HTTPS)
# :5001 {
#     reverse_proxy localhost:5001
# }
