<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OAuth Setup Wizard - Soulfra Platform</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .wizard-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }

    .wizard-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .wizard-header h1 {
      font-size: 32px;
      margin-bottom: 10px;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 4px;
      margin-top: 20px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: white;
      border-radius: 4px;
      transition: width 0.3s ease;
      width: 0%;
    }

    .wizard-body {
      display: grid;
      grid-template-columns: 400px 1fr;
      min-height: 600px;
    }

    .sidebar {
      background: #f5f5f5;
      padding: 30px;
      border-right: 1px solid #e0e0e0;
    }

    .step {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .step:hover {
      background: white;
    }

    .step.active {
      background: white;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .step.completed {
      opacity: 0.7;
    }

    .step-number {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: #e0e0e0;
      color: #666;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
    }

    .step.active .step-number {
      background: #667eea;
      color: white;
    }

    .step.completed .step-number {
      background: #4caf50;
      color: white;
    }

    .step-title {
      font-weight: 600;
      color: #333;
    }

    .content {
      padding: 40px;
    }

    .step-content {
      display: none;
    }

    .step-content.active {
      display: block;
      animation: fadeIn 0.3s;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .step-content h2 {
      font-size: 28px;
      margin-bottom: 20px;
      color: #333;
    }

    .step-content p {
      font-size: 16px;
      line-height: 1.6;
      color: #666;
      margin-bottom: 20px;
    }

    .credential-form {
      background: #f9f9f9;
      padding: 24px;
      border-radius: 8px;
      margin: 20px 0;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      font-family: 'Monaco', 'Courier New', monospace;
      transition: border-color 0.2s;
    }

    .form-group input:focus {
      outline: none;
      border-color: #667eea;
    }

    .form-group input.valid {
      border-color: #4caf50;
      background: #f1f8f4;
    }

    .form-group input.invalid {
      border-color: #f44336;
    }

    .help-text {
      font-size: 13px;
      color: #999;
      margin-top: 6px;
    }

    .instructions {
      background: #e3f2fd;
      border-left: 4px solid #2196f3;
      padding: 16px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .instructions h3 {
      margin-bottom: 12px;
      color: #1565c0;
    }

    .instructions ol {
      margin-left: 20px;
    }

    .instructions li {
      margin-bottom: 8px;
      color: #1976d2;
    }

    .instructions code {
      background: rgba(0, 0, 0, 0.05);
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
    }

    .preview-box {
      border: 2px dashed #667eea;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      background: #f0f3ff;
    }

    .preview-box h4 {
      margin-bottom: 12px;
      color: #667eea;
    }

    .preview-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #e0e0e0;
    }

    .preview-item:last-child {
      border-bottom: none;
    }

    .preview-label {
      font-weight: 600;
      color: #666;
    }

    .preview-value {
      color: #333;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
    }

    .button-group {
      display: flex;
      gap: 12px;
      margin-top: 30px;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: #e0e0e0;
      color: #666;
    }

    .btn-secondary:hover {
      background: #d0d0d0;
    }

    .btn-success {
      background: #4caf50;
      color: white;
    }

    .btn-success:hover {
      background: #45a049;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    .status-badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
    }

    .status-badge.success {
      background: #e8f5e9;
      color: #2e7d32;
    }

    .status-badge.pending {
      background: #fff3e0;
      color: #f57c00;
    }

    .status-badge.error {
      background: #ffebee;
      color: #c62828;
    }

    .provider-card {
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
      transition: all 0.2s;
    }

    .provider-card:hover {
      border-color: #667eea;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .provider-card.configured {
      border-color: #4caf50;
      background: #f1f8f4;
    }

    .provider-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .provider-name {
      font-size: 18px;
      font-weight: 600;
      color: #333;
    }

    .provider-icon {
      font-size: 24px;
    }

    .loading-spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #667eea;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .success-animation {
      text-align: center;
      padding: 40px;
    }

    .success-icon {
      font-size: 80px;
      margin-bottom: 20px;
      animation: scaleIn 0.5s ease-out;
    }

    @keyframes scaleIn {
      from { transform: scale(0); }
      to { transform: scale(1); }
    }

    .link-button {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
      padding: 8px 16px;
      border-radius: 6px;
      transition: background 0.2s;
    }

    .link-button:hover {
      background: #f0f3ff;
    }
  </style>
</head>
<body>
  <div class="wizard-container">
    <div class="wizard-header">
      <h1>üîê OAuth Setup Wizard</h1>
      <p>Set up OAuth authentication for Google, Microsoft, and GitHub</p>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
    </div>

    <div class="wizard-body">
      <div class="sidebar">
        <div class="step active" data-step="1">
          <div class="step-number">1</div>
          <div class="step-title">Welcome</div>
        </div>
        <div class="step" data-step="2">
          <div class="step-number">2</div>
          <div class="step-title">Configuration</div>
        </div>
        <div class="step" data-step="3">
          <div class="step-number">3</div>
          <div class="step-title">GitHub OAuth</div>
        </div>
        <div class="step" data-step="4">
          <div class="step-number">4</div>
          <div class="step-title">Google OAuth</div>
        </div>
        <div class="step" data-step="5">
          <div class="step-number">5</div>
          <div class="step-title">Microsoft OAuth</div>
        </div>
        <div class="step" data-step="6">
          <div class="step-number">6</div>
          <div class="step-title">Review & Test</div>
        </div>
        <div class="step" data-step="7">
          <div class="step-number">7</div>
          <div class="step-title">Complete</div>
        </div>
      </div>

      <div class="content">
        <!-- Step 1: Welcome -->
        <div class="step-content active" data-step="1">
          <h2>Welcome to OAuth Setup!</h2>
          <p>This wizard will guide you through setting up OAuth authentication with major providers. You'll be able to offer "Sign in with..." buttons for:</p>

          <div class="provider-card">
            <div class="provider-header">
              <span class="provider-name">üîµ Google</span>
              <span class="status-badge pending">Not configured</span>
            </div>
            <p style="font-size: 14px; color: #666; margin: 0;">Gmail, Google Drive, Calendar integration</p>
          </div>

          <div class="provider-card">
            <div class="provider-header">
              <span class="provider-name">üî∑ Microsoft</span>
              <span class="status-badge pending">Not configured</span>
            </div>
            <p style="font-size: 14px; color: #666; margin: 0;">Outlook, OneDrive, Office 365</p>
          </div>

          <div class="provider-card">
            <div class="provider-header">
              <span class="provider-name">‚ö´ GitHub</span>
              <span class="status-badge pending">Not configured</span>
            </div>
            <p style="font-size: 14px; color: #666; margin: 0;">Code repositories, developer tools</p>
          </div>

          <div class="instructions">
            <h3>What you'll need:</h3>
            <ul>
              <li>Account on each provider platform</li>
              <li>15-30 minutes of setup time</li>
              <li>Access to developer consoles</li>
            </ul>
          </div>

          <div class="button-group">
            <button class="btn btn-primary" onclick="nextStep()">Get Started</button>
          </div>
        </div>

        <!-- Step 2: Configuration -->
        <div class="step-content" data-step="2">
          <h2>Basic Configuration</h2>
          <p>First, let's configure some basic settings for your OAuth applications.</p>

          <div class="credential-form">
            <div class="form-group">
              <label>Application Name</label>
              <input type="text" id="appName" value="Soulfra Platform" placeholder="Your app name">
              <div class="help-text">This will be shown to users when they authorize</div>
            </div>

            <div class="form-group">
              <label>Homepage URL</label>
              <input type="url" id="homepageUrl" value="http://localhost:5001" placeholder="http://localhost:5001">
              <div class="help-text">The main URL of your application</div>
            </div>

            <div class="form-group">
              <label>OAuth Callback URL</label>
              <input type="url" id="callbackUrl" value="http://localhost:5001/api/auth/oauth/callback" placeholder="http://localhost:5001/api/auth/oauth/callback">
              <div class="help-text">Where OAuth providers will redirect after authorization</div>
            </div>
          </div>

          <div class="preview-box">
            <h4>üìã These values will be used across all providers</h4>
            <div class="preview-item">
              <span class="preview-label">App Name:</span>
              <span class="preview-value" id="previewAppName">Soulfra Platform</span>
            </div>
            <div class="preview-item">
              <span class="preview-label">Homepage:</span>
              <span class="preview-value" id="previewHomepage">http://localhost:5001</span>
            </div>
            <div class="preview-item">
              <span class="preview-label">Callback:</span>
              <span class="preview-value" id="previewCallback">http://localhost:5001/api/auth/oauth/callback</span>
            </div>
          </div>

          <div class="button-group">
            <button class="btn btn-secondary" onclick="prevStep()">Back</button>
            <button class="btn btn-primary" onclick="nextStep()">Continue</button>
          </div>
        </div>

        <!-- Step 3: GitHub -->
        <div class="step-content" data-step="3">
          <h2>‚ö´ GitHub OAuth Setup</h2>
          <p>Create an OAuth application on GitHub to enable "Sign in with GitHub" functionality.</p>

          <div class="instructions">
            <h3>üìù Setup Steps:</h3>
            <ol>
              <li>Open <a href="https://github.com/settings/developers" target="_blank" class="link-button">GitHub Developer Settings ‚Üó</a></li>
              <li>Click "New OAuth App"</li>
              <li>Fill in the form:
                <ul>
                  <li>Application name: <code id="githubAppName">Soulfra Platform</code></li>
                  <li>Homepage URL: <code id="githubHomepage">http://localhost:5001</code></li>
                  <li>Callback URL: <code id="githubCallback">http://localhost:5001/api/auth/oauth/callback</code></li>
                </ul>
              </li>
              <li>Click "Register application"</li>
              <li>Copy the Client ID</li>
              <li>Click "Generate a new client secret"</li>
              <li>Copy the Client Secret (you'll only see it once!)</li>
            </ol>
          </div>

          <div class="credential-form">
            <div class="form-group">
              <label>GitHub Client ID</label>
              <input type="text" id="githubClientId" placeholder="Iv1.abc123def456" oninput="validateGitHubCredentials()">
              <div class="help-text">Starts with "Iv1." or "Iv23."</div>
            </div>

            <div class="form-group">
              <label>GitHub Client Secret</label>
              <input type="password" id="githubClientSecret" placeholder="abc123def456..." oninput="validateGitHubCredentials()">
              <div class="help-text">Long alphanumeric string</div>
            </div>
          </div>

          <div class="button-group">
            <button class="btn btn-secondary" onclick="prevStep()">Back</button>
            <button class="btn btn-primary" id="githubNextBtn" onclick="nextStep()" disabled>Continue</button>
          </div>
        </div>

        <!-- Step 4: Google -->
        <div class="step-content" data-step="4">
          <h2>üîµ Google OAuth Setup</h2>
          <p>Create OAuth credentials in Google Cloud Console.</p>

          <div class="instructions">
            <h3>üìù Setup Steps:</h3>
            <ol>
              <li>Open <a href="https://console.cloud.google.com/apis/credentials" target="_blank" class="link-button">Google Cloud Console ‚Üó</a></li>
              <li>Create a project (if needed)</li>
              <li>Configure OAuth consent screen:
                <ul>
                  <li>App name: <code id="googleAppName">Soulfra Platform</code></li>
                  <li>Add scopes: openid, email, profile</li>
                </ul>
              </li>
              <li>Create Credentials ‚Üí OAuth client ID</li>
              <li>Application type: <strong>Web application</strong></li>
              <li>Add authorized redirect URI: <code id="googleCallback">http://localhost:5001/api/auth/oauth/callback</code></li>
              <li>Copy Client ID and Client Secret</li>
            </ol>
          </div>

          <div class="credential-form">
            <div class="form-group">
              <label>Google Client ID</label>
              <input type="text" id="googleClientId" placeholder="123456789-abc.apps.googleusercontent.com" oninput="validateGoogleCredentials()">
              <div class="help-text">Ends with ".apps.googleusercontent.com"</div>
            </div>

            <div class="form-group">
              <label>Google Client Secret</label>
              <input type="password" id="googleClientSecret" placeholder="GOCSPX-..." oninput="validateGoogleCredentials()">
              <div class="help-text">Starts with "GOCSPX-"</div>
            </div>
          </div>

          <div class="button-group">
            <button class="btn btn-secondary" onclick="prevStep()">Back</button>
            <button class="btn btn-primary" id="googleNextBtn" onclick="nextStep()" disabled>Continue</button>
          </div>
        </div>

        <!-- Step 5: Microsoft -->
        <div class="step-content" data-step="5">
          <h2>üî∑ Microsoft OAuth Setup</h2>
          <p>Register an application in Azure Portal.</p>

          <div class="instructions">
            <h3>üìù Setup Steps:</h3>
            <ol>
              <li>Open <a href="https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps" target="_blank" class="link-button">Azure Portal ‚Üó</a></li>
              <li>Click "New registration"</li>
              <li>Fill in:
                <ul>
                  <li>Name: <code id="msAppName">Soulfra Platform</code></li>
                  <li>Supported account types: Any organizational directory + personal accounts</li>
                  <li>Redirect URI: Web ‚Üí <code id="msCallback">http://localhost:5001/api/auth/oauth/callback</code></li>
                </ul>
              </li>
              <li>Copy Application (client) ID</li>
              <li>Go to "Certificates & secrets"</li>
              <li>Click "New client secret"</li>
              <li>Copy the secret value immediately!</li>
            </ol>
          </div>

          <div class="credential-form">
            <div class="form-group">
              <label>Microsoft Client ID</label>
              <input type="text" id="msClientId" placeholder="12345678-1234-1234-1234-123456789abc" oninput="validateMSCredentials()">
              <div class="help-text">UUID format (8-4-4-4-12 characters)</div>
            </div>

            <div class="form-group">
              <label>Microsoft Client Secret</label>
              <input type="password" id="msClientSecret" placeholder="abc~123def-456..." oninput="validateMSCredentials()">
              <div class="help-text">Contains special characters like ~ - .</div>
            </div>
          </div>

          <div class="button-group">
            <button class="btn btn-secondary" onclick="prevStep()">Back</button>
            <button class="btn btn-primary" id="msNextBtn" onclick="nextStep()" disabled>Continue</button>
          </div>
        </div>

        <!-- Step 6: Review -->
        <div class="step-content" data-step="6">
          <h2>üìã Review & Test</h2>
          <p>Review your configuration before saving. We'll test the OAuth flows to ensure everything works.</p>

          <div class="preview-box">
            <h4>Configuration Summary</h4>
            <div class="preview-item">
              <span class="preview-label">App Name:</span>
              <span class="preview-value" id="reviewAppName"></span>
            </div>
            <div class="preview-item">
              <span class="preview-label">Homepage URL:</span>
              <span class="preview-value" id="reviewHomepage"></span>
            </div>
            <div class="preview-item">
              <span class="preview-label">Callback URL:</span>
              <span class="preview-value" id="reviewCallback"></span>
            </div>
          </div>

          <div class="preview-box">
            <h4>OAuth Providers</h4>
            <div class="provider-card configured">
              <div class="provider-header">
                <span class="provider-name">‚ö´ GitHub</span>
                <span class="status-badge success">Configured</span>
              </div>
              <div class="preview-item">
                <span class="preview-label">Client ID:</span>
                <span class="preview-value" id="reviewGithubId"></span>
              </div>
            </div>

            <div class="provider-card configured">
              <div class="provider-header">
                <span class="provider-name">üîµ Google</span>
                <span class="status-badge success">Configured</span>
              </div>
              <div class="preview-item">
                <span class="preview-label">Client ID:</span>
                <span class="preview-value" id="reviewGoogleId"></span>
              </div>
            </div>

            <div class="provider-card configured">
              <div class="provider-header">
                <span class="provider-name">üî∑ Microsoft</span>
                <span class="status-badge success">Configured</span>
              </div>
              <div class="preview-item">
                <span class="preview-label">Client ID:</span>
                <span class="preview-value" id="reviewMsId"></span>
              </div>
            </div>
          </div>

          <div class="button-group">
            <button class="btn btn-secondary" onclick="prevStep()">Back</button>
            <button class="btn btn-success" onclick="saveAndTest()">Save & Test</button>
          </div>
        </div>

        <!-- Step 7: Complete -->
        <div class="step-content" data-step="7">
          <div class="success-animation">
            <div class="success-icon">‚úÖ</div>
            <h2>Setup Complete!</h2>
            <p>Your OAuth providers have been configured successfully.</p>
          </div>

          <div class="preview-box">
            <h4>‚ú® What's Next?</h4>
            <ol style="margin-left: 20px;">
              <li>OAuth credentials saved to .env file</li>
              <li>Database configured with provider information</li>
              <li>Ready to test OAuth flows</li>
            </ol>
          </div>

          <div class="button-group" style="justify-content: center;">
            <a href="/oauth-login.html" class="btn btn-primary">Test OAuth Login</a>
            <a href="/dashboard.html" class="btn btn-secondary">Go to Dashboard</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Wizard state
    let currentStep = 1;
    const totalSteps = 7;

    // Configuration
    const config = {
      appName: 'Soulfra Platform',
      homepageUrl: 'http://localhost:5001',
      callbackUrl: 'http://localhost:5001/api/auth/oauth/callback',
      github: { clientId: '', clientSecret: '' },
      google: { clientId: '', clientSecret: '' },
      microsoft: { clientId: '', clientSecret: '' }
    };

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updateProgress();
      setupEventListeners();
    });

    function setupEventListeners() {
      // Update config preview when inputs change
      document.getElementById('appName')?.addEventListener('input', (e) => {
        config.appName = e.target.value;
        updatePreviews();
      });

      document.getElementById('homepageUrl')?.addEventListener('input', (e) => {
        config.homepageUrl = e.target.value;
        updatePreviews();
      });

      document.getElementById('callbackUrl')?.addEventListener('input', (e) => {
        config.callbackUrl = e.target.value;
        updatePreviews();
      });

      // Store credentials
      document.getElementById('githubClientId')?.addEventListener('input', (e) => {
        config.github.clientId = e.target.value;
      });

      document.getElementById('githubClientSecret')?.addEventListener('input', (e) => {
        config.github.clientSecret = e.target.value;
      });

      document.getElementById('googleClientId')?.addEventListener('input', (e) => {
        config.google.clientId = e.target.value;
      });

      document.getElementById('googleClientSecret')?.addEventListener('input', (e) => {
        config.google.clientSecret = e.target.value;
      });

      document.getElementById('msClientId')?.addEventListener('input', (e) => {
        config.microsoft.clientId = e.target.value;
      });

      document.getElementById('msClientSecret')?.addEventListener('input', (e) => {
        config.microsoft.clientSecret = e.target.value;
      });
    }

    function updatePreviews() {
      // Step 2 previews
      document.getElementById('previewAppName').textContent = config.appName;
      document.getElementById('previewHomepage').textContent = config.homepageUrl;
      document.getElementById('previewCallback').textContent = config.callbackUrl;

      // GitHub previews
      document.getElementById('githubAppName').textContent = config.appName;
      document.getElementById('githubHomepage').textContent = config.homepageUrl;
      document.getElementById('githubCallback').textContent = config.callbackUrl;

      // Google previews
      document.getElementById('googleAppName').textContent = config.appName;
      document.getElementById('googleCallback').textContent = config.callbackUrl;

      // Microsoft previews
      document.getElementById('msAppName').textContent = config.appName;
      document.getElementById('msCallback').textContent = config.callbackUrl;

      // Review previews
      document.getElementById('reviewAppName').textContent = config.appName;
      document.getElementById('reviewHomepage').textContent = config.homepageUrl;
      document.getElementById('reviewCallback').textContent = config.callbackUrl;
      document.getElementById('reviewGithubId').textContent = config.github.clientId.slice(0, 30) + '...';
      document.getElementById('reviewGoogleId').textContent = config.google.clientId.slice(0, 30) + '...';
      document.getElementById('reviewMsId').textContent = config.microsoft.clientId;
    }

    function validateGitHubCredentials() {
      const clientId = document.getElementById('githubClientId').value;
      const clientSecret = document.getElementById('githubClientSecret').value;
      const btn = document.getElementById('githubNextBtn');

      const valid = clientId.length > 10 && clientSecret.length > 10;
      btn.disabled = !valid;

      if (valid) {
        document.getElementById('githubClientId').classList.add('valid');
        document.getElementById('githubClientSecret').classList.add('valid');
      }
    }

    function validateGoogleCredentials() {
      const clientId = document.getElementById('googleClientId').value;
      const clientSecret = document.getElementById('googleClientSecret').value;
      const btn = document.getElementById('googleNextBtn');

      const valid = clientId.includes('.apps.googleusercontent.com') &&
                    clientSecret.startsWith('GOCSPX-');
      btn.disabled = !valid;

      if (valid) {
        document.getElementById('googleClientId').classList.add('valid');
        document.getElementById('googleClientSecret').classList.add('valid');
      }
    }

    function validateMSCredentials() {
      const clientId = document.getElementById('msClientId').value;
      const clientSecret = document.getElementById('msClientSecret').value;
      const btn = document.getElementById('msNextBtn');

      const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
      const valid = uuidRegex.test(clientId) && clientSecret.length > 10;
      btn.disabled = !valid;

      if (valid) {
        document.getElementById('msClientId').classList.add('valid');
        document.getElementById('msClientSecret').classList.add('valid');
      }
    }

    function nextStep() {
      if (currentStep < totalSteps) {
        goToStep(currentStep + 1);
      }
    }

    function prevStep() {
      if (currentStep > 1) {
        goToStep(currentStep - 1);
      }
    }

    function goToStep(step) {
      // Deactivate current step
      document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
      document.querySelector(`.step-content[data-step="${currentStep}"]`).classList.remove('active');

      // Mark previous steps as completed
      for (let i = 1; i < step; i++) {
        document.querySelector(`.step[data-step="${i}"]`).classList.add('completed');
      }

      // Activate new step
      currentStep = step;
      document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
      document.querySelector(`.step-content[data-step="${currentStep}"]`).classList.add('active');

      // Update progress
      updateProgress();

      // Update previews
      updatePreviews();

      // Scroll to top
      window.scrollTo(0, 0);
    }

    function updateProgress() {
      const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
    }

    async function saveAndTest() {
      // Save configuration
      console.log('Saving configuration:', config);

      // TODO: Make API call to save credentials
      // await fetch('/api/oauth/setup', {
      //   method: 'POST',
      //   headers: { 'Content-Type': 'application/json' },
      //   body: JSON.stringify(config)
      // });

      alert('Configuration saved! (In production, this would save to .env and database)');

      // Go to completion step
      nextStep();
    }

    // Allow clicking on sidebar steps
    document.querySelectorAll('.step').forEach(step => {
      step.addEventListener('click', () => {
        const stepNum = parseInt(step.dataset.step);
        if (stepNum <= currentStep + 1) {
          goToStep(stepNum);
        }
      });
    });
  </script>
</body>
</html>
